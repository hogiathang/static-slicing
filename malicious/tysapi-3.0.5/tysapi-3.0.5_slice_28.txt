this.config.middleware.settings = Object.keys(this.middleware).reduce((acc, current) => {
    // Try to find the settings in the current environment, then in the main configurations.
    const currentSettings = merge(get(cloneDeep(this.middleware[current]), ['defaults', current], {}), flattenMiddlewaresConfig[current] || this.config.currentEnvironment[current] || this.config[current]);
    acc[current] = !isObject(currentSettings) ? {} : currentSettings;

    if (!acc[current].hasOwnProperty('enabled')) {
      this.log.warn(`(middleware:${current}) wasn't loaded due to missing key \`enabled\` in the configuration`);
    }

    // Ensure that enabled key exist by forcing to false.
    defaults(acc[current], { enabled : false });

    return acc;
  }, {})
const currentSettings = merge(get(cloneDeep(this.middleware[current]), ['defaults', current], {}), flattenMiddlewaresConfig[current] || this.config.currentEnvironment[current] || this.config[current])
