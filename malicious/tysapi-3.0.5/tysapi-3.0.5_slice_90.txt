module.exports = function (plugin, cliArguments) {
  // Define variables.
  const pluginPrefix = 'tysapi-plugin-';
  const pluginID = `${pluginPrefix}${plugin}`;
  const pluginPath = `./plugins/${plugin}`;

  let loader = ora(`Install ${cyan(plugin)} plugin`).start();

  // Check that we're in a valid Tysapi project.
  if (!cli.isTysapiApp()) {
    return loader.fail('This command can only be used inside a Tysapi project.');
  }

  // Check that the plugin is not installed yet.
  if (fs.existsSync(pluginPath)) {
    loader.fail(`It looks like this plugin is already installed. Please check in \`${cyan(pluginPath)}\`.`);
    process.exit(1);
  }

  if (cliArguments.dev) {
    try {
      fs.symlinkSync(path.resolve(__dirname, '..', '..', pluginID), path.resolve(process.cwd(), pluginPath), 'junction');

      loader.succeed(`The ${cyan(plugin)} plugin has been successfully installed.`);
      process.exit(0);
    } catch (e) {
      console.log(e);
      loader.fail('An error occurred ...
const pluginPrefix = 'tysapi-plugin-'
<operator>.formatString("", pluginPrefix, "", plugin, "")
<operator>.formatString("./plugins/", plugin, "")
<operator>.formatString("Install ", cyan(plugin), " plugin")
!cli.isTysapiApp()
fs.existsSync(pluginPath)
<operator>.formatString("It looks like this plugin is already installed. Please check in \`", cyan(pluginPath), "\`.")
process.exit(1)
cliArguments.dev
const isTysapiInstalledWithNPM = packageManager.isTysapiInstalledWithNPM()
!isTysapiInstalledWithNPM
shell.mkdir('-p', [pluginPath])
fs.writeFileSync(`${pluginPath}/package.json`, JSON.stringify({}), 'utf8')
isTysapiInstalledWithNPM ? <operator>.formatString("npm link ", pluginID, "") : <operator>.formatString("yarn link ", pluginID, "")
shell.exec(cmd, {silent: true}, (code) => {
      if (code) {
        loader.fail(`An error occurred during plugin installation. \nPlease make sure this plugin is available on npm: https://www.npmjs.com/package/${pluginID}`);
        process.exit(1);
      }

      // Remove the created package.json needed for yarn
      if (!isTysapiInstalledWithNPM) {
        shell.rm('-r', `${pluginPath}/package.json`);
      }

      try {
        const prjPath = path.resolve(process.cwd(), 'node_modules', `${pluginID}`);

        // Move the plugin from the `node_modules` folder to the `./plugins` folder.
        loader.info(`FROM ${prjPath}`);
        loader.info(`TO ${pluginPath}`);

        // fs.copySync(`${pluginPath}/node_modules/${pluginID}`, pluginPath, {
        //   overwrite: true,
        //   dereference: true,
        // });

        fs.copySync(prjPath, pluginPath, {
          overwrite: true,
          dereference: true,
        });
        // Copy .gitignore because the file is...
