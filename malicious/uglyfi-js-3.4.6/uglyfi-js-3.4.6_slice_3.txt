function flatten_vars = function flatten_vars(decls, expressions) {
            var pos = expressions.length;
            for (var i = 0, lines = fn.body.length; i < lines; i++) {
                var stat = fn.body[i];
                if (!(stat instanceof AST_Var)) continue;
                for (var j = 0, defs = stat.definitions.length; j < defs; j++) {
                    var var_def = stat.definitions[j];
                    var name = var_def.name;
                    var redef = name.definition().redefined();
                    if (redef) {
                        name = name.clone();
                        name.thedef = redef;
                    }
                    append_var(decls, expressions, name, var_def.value);
                    if (in_loop && all(fn.argnames, function(argname) {
                        return argname.name != name.name;
                    })) {
                        var def = fn.variables.get(name.name);
                        var sym = make_node(AST_SymbolRef, name...
var pos = expressions.length
var lines = fn.body.length
var stat = fn.body[i]
!(stat instanceof AST_Var)
var defs = stat.definitions.length
var var_def = stat.definitions[j]
var name = var_def.name
var redef = name.definition().redefined()
name = name.clone()
name.thedef = redef
append_var(decls, expressions, name, var_def.value)
in_loop && all(fn.argnames, function(argname) {
                        return argname.name != name.name;
                    })
var def = fn.variables.get(name.name)
var sym = make_node(AST_SymbolRef, name, name)
(_tmp_535 = def.references).push
expressions.splice(pos++, 0, make_node(AST_Assign, var_def, {
                            operator: "=",
                            left: sym,
                            right: make_node(AST_Undefined, name)
                        }))
_tmp_536.operator = "="
_tmp_536.left = sym
_tmp_536.right = make_node(AST_Undefined, name)
