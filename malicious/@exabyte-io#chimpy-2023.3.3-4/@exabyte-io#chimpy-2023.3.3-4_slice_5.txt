_tmp_0.setupBrowserAndDDP = <lambda>3
var setupBrowser = function () {
      log.debug('[chimp][helper] getting browser');

      const webdriverioConfigOptions = JSON.parse(process.env['chimp.webdriverio']);
      const webdriverioOptions = merge(
        webdriverioConfigOptions,
        {
          desiredCapabilities: {
            browserName: parseNullableString(process.env['chimp.browser']),
            platform: parseNullableString(process.env['chimp.platform']),
            name: parseNullableString(process.env['chimp.name']),
            version: parseNullableString(process.env['chimp.browserVersion']),
            deviceName: parseNullableString(process.env['chimp.deviceName']),
          },
          user: parseNullableString(process.env['chimp.user'] || process.env.SAUCE_USERNAME),
          key: parseNullableString(process.env['chimp.key'] || process.env.SAUCE_ACCESS_KEY),
          host: parseNullableString(process.env['chimp.host']),
          port: parseNullableInteger(process.env['chimp.port']),
          ...
var initSingleBrowser = function (browser) {
      log.debug('[chimp][helper] init browser');
      log.debug('[chimp][helper] init browser callback');

      browser.screenshotsCount = 0;
      browser.addCommand('capture', function (name, screenshotsPathPrefix) {

        const screenshotsCountForFileName = `${(browser.screenshotsCount++)}_`;
        let fileName = name.replace(/[ \\~#%&*{}/:<>?|"-]/g, '_');
        const fileExtension = '.png';

        const suggestedFileNameLength = screenshotsCountForFileName.length + fileName.length + fileExtension.length;
        if (suggestedFileNameLength > 255) {
          const numberOfCharactersToLeave = (fileName.length - (suggestedFileNameLength - 255));
          fileName = fileName.substr(0, numberOfCharactersToLeave);
        }

        const fullFileName = `${screenshotsCountForFileName}${fileName}${fileExtension}`;
        let screenshotsPath = process.env['chimp.screenshotsPath'];
        if (screenshotsPathPrefix) {
          scree...
var initBrowser = function () {
      log.debug('[chimp][hooks] init browser');
      var browser = global.browser;
      log.debug('[chimp][hooks] init browser callback');

      if (browser.instances) {
        browser.instances.forEach(function (singleBrowser) {
          const desiredCapabilities = singleBrowser.initSync();
          singleBrowser.desiredCapabilities = desiredCapabilities;
          initSingleBrowser(singleBrowser);
        });
      }
      else {
        const desiredCapabilities = browser.initSync();
        browser.desiredCapabilities = desiredCapabilities;
        initSingleBrowser(browser);
      }

    }
var addServerExecute = function (ddpInstance) {
      ddpInstance.execute = function (func) {
        var args = Array.prototype.slice.call(arguments, 1);
        var result;
        var timeout = parseInt(process.env['chimp.serverExecuteTimeout']) || 10000;
        setTimeout(function() {
          if (!result) {
            throw new Error('[chimp] server.execute timeout after ' + timeout + 'ms'); 
          }
        }, timeout);
        try {
          result = ddpInstance.call('xolvio/backdoor', func.toString(), args);
        } catch (exception) {
          if (exception.error === 404) {
            throw new Error('[chimp] You need to install xolvio:backdoor in your meteor app before you can use server.execute()');

          } else {
            throw exception;
          }
        }
        if (result.error) {
          var error = new Error('Error in server.execute' + result.error.message);
          error.stack += '\n' + result.error.stack.replace(/ {4}at/g, '  @');
         ...
var setupDdp = function () {
      log.debug('[chimp][helper] setup DDP');
      if (process.env['chimp.ddp0']) {
        try {
          log.debug('[chimp][helper] connecting via DDP to', process.env['chimp.ddp0']);
          global.ddp.connectSync();
          addServerExecute(global.ddp);
          for(let i = 0; i < global.ddp.instances.length; i++) {
            log.debug('[chimp][helper] connecting via DDP to ' + global.ddp.instances[i]._original.host + ':' + global.ddp.instances[i]._original.port);
            global.ddp.instances[i].connectSync();
            addServerExecute(global.ddp.instances[i]);
          }
          log.debug('[chimp][helper] connecting via DDP had no error');
        } catch (error) {
          let errorMessage = error;
          if (_.isObject(error)) {
            if (error.code === 'ECONNREFUSED') {
              log.error('[chimp][helper] Cannot connect to Meteor. Please check if your application is up and running on ' + error.address + ' port ' + er...
setupBrowser()
initBrowser()
booleanHelper.isTruthy(process.env['chimp.ddp0'])
setupDdp()
log.error('[chimp][helper] setupBrowserAndDDP had error')
log.error(error)
log.error(error.stack)
