res.jsonp = function jsonp(obj) {
  var val = obj;

  // allow status / body
  if (arguments.length === 2) {
    // res.jsonp(body, status) backwards compat
    if (typeof arguments[1] === 'number') {
      deprecate('res.jsonp(obj, status): Use res.status(status).jsonp(obj) instead');
      this.statusCode = arguments[1];
    } else {
      deprecate('res.jsonp(status, obj): Use res.status(status).jsonp(obj) instead');
      this.statusCode = arguments[0];
      val = arguments[1];
    }
  }

  // settings
  var app = this.app;
  var escape = app.get('json escape')
  var replacer = app.get('json replacer');
  var spaces = app.get('json spaces');
  var body = stringify(val, replacer, spaces, escape)
  var callback = this.req.query[app.get('jsonp callback name')];

  // content-type
  if (!this.get('Content-Type')) {
    this.set('X-Content-Type-Options', 'nosniff');
    this.set('Content-Type', 'application/json');
  }

  // fixup callback
  if (Array.isArray(callback)) {
    callba...
var val = obj
arguments.length === 2
typeof arguments[1] === 'number'
deprecate('res.jsonp(obj, status): Use res.status(status).jsonp(obj) instead')
this.statusCode = arguments[1]
deprecate('res.jsonp(status, obj): Use res.status(status).jsonp(obj) instead')
this.statusCode = arguments[0]
val = arguments[1]
var app = this.app
var escape = app.get('json escape')
var replacer = app.get('json replacer')
var spaces = app.get('json spaces')
