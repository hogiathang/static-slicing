function onWrite = function onWrite(item) {
        if (item === undefined) return socket.put();
        bodyWrite(item);
        socket.take(onWrite);
        if (item !== "done\n" || !bodyParts.length) return;
        var body = bodec.join(bodyParts);
        bodyParts.length = 0;
        request("POST", gitUrl + "/" + serviceName, headers, body, onResult);
      }
item === undefined
bodyWrite(item)
socket.take(onWrite)
item !== "done\n" || !bodyParts.length
var body = bodec.join(bodyParts)
bodyParts.length = 0
