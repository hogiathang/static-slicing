function done = function done(err) {

      stdout = stdout && stdout.trim()
      var result
      switch (params[0]) {
        case 'rsa':
          result = /^Rsa key ok$/i.test(stdout)
          break
        default:
          result = /Signature Algorithm/im.test(stdout)
          break
      }
      if (!result) {
        if (openssl.get('Vendor') === "OPENSSL" && openssl.get('VendorVersionMajor') >= 3) {
          if (!(stderr && stderr.toString().trim().endsWith('verify OK'))) {
            return callback(new Error(stderr.toString()))
          }
        }
        if (err && err.toString().trim() !== 'verify OK') {
          return callback(err)
        }
      }
      callback(null, result)
    }
stdout = stdout && stdout.trim()
params[0]
"rsa"
result = /^Rsa key ok$/i.test(stdout)
break
default:
result = /Signature Algorithm/im.test(stdout)
break
!result
openssl.get('Vendor') === "OPENSSL" && openssl.get('VendorVersionMajor') >= 3
