function callLoaderOrAction = async function callLoaderOrAction(
  type: "loader" | "action",
  request: Request,
  match: AgnosticDataRouteMatch,
  matches: AgnosticDataRouteMatch[],
  manifest: RouteManifest,
  mapRouteProperties: MapRoutePropertiesFunction,
  basename: string,
  opts: {
    isStaticRequest?: boolean;
    isRouteRequest?: boolean;
    requestContext?: unknown;
  } = {}
): Promise<DataResult> {
  let resultType;
  let result;
  let onReject: (() => void) | undefined;

  let runHandler = (handler: ActionFunction | LoaderFunction) => {
    // Setup a promise we can race against so that abort signals short circuit
    let reject: () => void;
    let abortPromise = new Promise((_, r) => (reject = r));
    onReject = () => reject();
    request.signal.addEventListener("abort", onReject);
    return Promise.race([
      handler({
        request,
        params: match.params,
        context: opts.requestContext,
      }),
      abortPromise,
    ]);
  };

  try {
    let handler = match.route[type];...
opts = opts === void 0 ? {} : opts
let runHandler = (handler: ActionFunction | LoaderFunction) => {
    // Setup a promise we can race against so that abort signals short circuit
    let reject: () => void;
    let abortPromise = new Promise((_, r) => (reject = r));
    onReject = () => reject();
    request.signal.addEventListener("abort", onReject);
    return Promise.race([
      handler({
        request,
        params: match.params,
        context: opts.requestContext,
      }),
      abortPromise,
    ]);
  }
let handler = match.route[type]
match.route.lazy
let values = await Promise.all([
          // If the handler throws, don't let it immediately bubble out,
          // since we need to let the lazy() execution finish so we know if this
          // route has a boundary that can handle the error
          runHandler(handler).catch((e) => {
            handlerError = e;
          }),
          loadLazyRouteModule(match.route, mapRouteProperties, manifest),
        ])
_tmp_35.push(runHandler(handler).catch((e) => {
            handlerError = e;
          }))
_tmp_35.push(loadLazyRouteModule(match.route, mapRouteProperties, manifest))
throw handlerError;
result = values[0]
await loadLazyRouteModule(match.route, mapRouteProperties, manifest)
handler = match.route[type]
result = await runHandler(handler)
type === "action"
let url = new URL(request.url)
let pathname = url.pathname + url.search
throw getInternalRouterError(405, {
            method: request.method,
            pathname,
            routeId: match.route.id,
          });
_tmp_38.method = request.method
_tmp_38.pathname = pathname
_tmp_38.routeId = match.route.id
!handler
let url = new URL(request.url)
let pathname = url.pathname + url.search
throw getInternalRouterError(404, {
        pathname,
      });
_tmp_41.pathname = pathname
result = await runHandler(handler)
invariant(
      result !== undefined,
      `You defined ${type === "action" ? "an action" : "a loader"} for route ` +
        `"${match.route.id}" but didn't return anything from your \`${type}\` ` +
        `function. Please return a value or \`null\`.`
    )
result !== undefined
`You defined ${type === "action" ? "an action" : "a loader"} for route ` +
        `"${match.route.id}" but didn't return anything from your \`${type}\` ` +
        `function. Please return a value or \`null\`.`
<operator>.formatString(""", match.route.id, "" but didn't return anything from your \`", type, "\` ")
"function. Please return a value or \`null\`."
resultType = ResultType.error
result = e
request.signal.removeEventListener("abort", onReject)
isResponse(result)
let status = result.status
redirectStatusCodes.has(status)
opts.isRouteRequest
let queryRouteResponse: QueryRouteResponse = {
        type:
          resultType === ResultType.error ? ResultType.error : ResultType.data,
        response: result,
      }
_tmp_52.type = resultType === ResultType.error ? ResultType.error : ResultType.data
resultType === ResultType.error ? ResultType.error : ResultType.data
_tmp_52.response = result
throw queryRouteResponse;
let contentType = result.headers.get("Content-Type")
