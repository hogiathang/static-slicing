var rr = require('railroad-diagrams')
console.log('Error: When you installed nearley, the dependency "railroad-diagrams" failed to install. Try running "npm install -g nearley" to re-install nearley. If that doesn\'t fix the problem, please file an issue on the nearley GitHub repository.')
process.exit(1)
var fs = require('fs')
var path = require('path')
var opts = require('commander')
var version = require('../package.json').version
opts.version(version, '-v, --version')
    .arguments('<file.ne>')
    .option('-o, --out [filename.svg]', 'File to output to (default stdout).', false)
    .parse(process.argv)
"<file.ne>"
"File to output to (default stdout)."
process.argv
var input = opts.args[0] ? fs.createReadStream(opts.args[0]) : process.stdin
var output = opts.out ? fs.createWriteStream(opts.out) : process.stdout
function railroad = function railroad(grm) {
    var rules = {};
    grm.forEach(function(instr) {
        if (instr.rules) {
            if (!rules[instr.name]) {
                rules[instr.name] = [];
            }
            rules[instr.name] = rules[instr.name].concat(instr.rules);
        }
    });

    var style = fs.readFileSync(
        path.join(
            path.dirname(require.resolve('railroad-diagrams')),
            'railroad-diagrams.css'
        )
    );

    var diagrams = Object.keys(rules).map(function(r) {
        return [
          '<h1><code>' + r + '</code></h1>',
          '<div>',
            diagram(r).toString(),
          '</div>'
        ].join('\n');
    });

    function diagram(name) {
        var selectedrules = rules[name];
        var outer = {subexpression: selectedrules};

        function renderTok(tok) {
            // ctx translated to correct position already
            if (tok.subexpression) {
                return new rr.Choice(0, tok.subexpression.map(ren...
