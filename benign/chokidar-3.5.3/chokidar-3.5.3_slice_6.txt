function setFSEventsListener = function setFSEventsListener(path, realPath, listener, rawEmitter) {
  let watchPath = sysPath.extname(realPath) ? sysPath.dirname(realPath) : realPath;

  const parentPath = sysPath.dirname(watchPath);
  let cont = FSEventsWatchers.get(watchPath);

  // If we've accumulated a substantial number of paths that
  // could have been consolidated by watching one directory
  // above the current one, create a watcher on the parent
  // path instead, so that we do consolidate going forward.
  if (couldConsolidate(parentPath)) {
    watchPath = parentPath;
  }

  const resolvedPath = sysPath.resolve(path);
  const hasSymlink = resolvedPath !== realPath;

  const filteredListener = (fullPath, flags, info) => {
    if (hasSymlink) fullPath = fullPath.replace(realPath, resolvedPath);
    if (
      fullPath === resolvedPath ||
      !fullPath.indexOf(resolvedPath + sysPath.sep)
    ) listener(fullPath, flags, info);
  };

  // check if there is already a watcher on a parent path
  // modifies...
let watchPath = sysPath.extname(realPath) ? sysPath.dirname(realPath) : realPath
const parentPath = sysPath.dirname(watchPath)
let cont = FSEventsWatchers.get(watchPath)
couldConsolidate(parentPath)
watchPath = parentPath
const resolvedPath = sysPath.resolve(path)
const hasSymlink = resolvedPath !== realPath
const filteredListener = (fullPath, flags, info) => {
    if (hasSymlink) fullPath = fullPath.replace(realPath, resolvedPath);
    if (
      fullPath === resolvedPath ||
      !fullPath.indexOf(resolvedPath + sysPath.sep)
    ) listener(fullPath, flags, info);
  }
let watchedParent = false
_iterator_0 = <operator>.iterator(FSEventsWatchers.keys())
realPath.indexOf(sysPath.resolve(watchedPath) + sysPath.sep) === 0
watchPath = watchedPath
cont = FSEventsWatchers.get(watchPath)
