ClientHttp.prototype._request = function(request, callback) {
  const self = this;
  // copies options so object can be modified in this context
  const options = utils.merge({}, this.options);

  utils.JSON.stringify(request, options, function(err, body) {
    if(err) {
      return callback(err);
    }

    options.method = options.method || 'POST';

    const headers = {
      'Content-Length': Buffer.byteLength(body, options.encoding),
      'Content-Type': 'application/json; charset=utf-8',
      Accept: 'application/json',
      'User-Agent': `jayson-${version}`,
    };

    // let user override the headers
    options.headers = utils.merge(headers, options.headers || {});

    const req = self._getRequestStream(options);

    self.emit('http request', req);

    req.on('response', function(res) {
      self.emit('http response', res, req);

      res.setEncoding(options.encoding);

      let data = '';
      res.on('data', function(chunk) { data += chunk; });

      res.on('e...
const self = this
const options = utils.merge({}, this.options)
utils.JSON.stringify(request, options, function(err, body) {
    if(err) {
      return callback(err);
    }

    options.method = options.method || 'POST';

    const headers = {
      'Content-Length': Buffer.byteLength(body, options.encoding),
      'Content-Type': 'application/json; charset=utf-8',
      Accept: 'application/json',
      'User-Agent': `jayson-${version}`,
    };

    // let user override the headers
    options.headers = utils.merge(headers, options.headers || {});

    const req = self._getRequestStream(options);

    self.emit('http request', req);

    req.on('response', function(res) {
      self.emit('http response', res, req);

      res.setEncoding(options.encoding);

      let data = '';
      res.on('data', function(chunk) { data += chunk; });

      res.on('end', function() {

        // assume we have an error
        if(res.statusCode < 200 || res.statusCode >= 300) {
          // assume the server gave the reason in the body
          const err = ne...
