function makeClientMetadata = function makeClientMetadata(options: MakeClientMetadataOptions): ClientMetadata {
  const metadataDocument = new LimitedSizeDocument(512);

  const { appName = '' } = options;
  // Add app name first, it must be sent
  if (appName.length > 0) {
    const name =
      Buffer.byteLength(appName, 'utf8') <= 128
        ? options.appName
        : Buffer.from(appName, 'utf8').subarray(0, 128).toString('utf8');
    metadataDocument.ifItFitsItSits('application', { name });
  }

  const { name = '', version = '', platform = '' } = options.driverInfo;

  const driverInfo = {
    name: name.length > 0 ? `nodejs|${name}` : 'nodejs',
    version: version.length > 0 ? `${NODE_DRIVER_VERSION}|${version}` : NODE_DRIVER_VERSION
  };

  if (!metadataDocument.ifItFitsItSits('driver', driverInfo)) {
    throw new MongoInvalidArgumentError(
      'Unable to include driverInfo name and version, metadata cannot exceed 512 bytes'
    );
  }

  let runtimeInfo = getRuntimeInfo();
  if (platform.length > 0...
const metadataDocument = new LimitedSizeDocument(512)
appName = _tmp_6.appName === void 0 ? "" : _tmp_6.appName
appName.length > 0
const name =
      Buffer.byteLength(appName, 'utf8') <= 128
        ? options.appName
        : Buffer.from(appName, 'utf8').subarray(0, 128).toString('utf8')
Buffer.byteLength(appName, 'utf8') <= 128 ? options.appName : Buffer.from(appName, 'utf8').subarray(0, 128).toString('utf8')
options.appName
(_tmp_7 = Buffer.from(appName, 'utf8').subarray(0, 128)).toString
metadataDocument.ifItFitsItSits('application', { name })
platform = _tmp_10.platform === void 0 ? "" : _tmp_10.platform
const driverInfo = {
    name: name.length > 0 ? `nodejs|${name}` : 'nodejs',
    version: version.length > 0 ? `${NODE_DRIVER_VERSION}|${version}` : NODE_DRIVER_VERSION
  }
_tmp_11.name = name.length > 0 ? <operator>.formatString("nodejs|", name, "") : "nodejs"
_tmp_11.version = version.length > 0 ? <operator>.formatString("", NODE_DRIVER_VERSION, "|", version, "") : NODE_DRIVER_VERSION
!metadataDocument.ifItFitsItSits('driver', driverInfo)
throw new MongoInvalidArgumentError(
      'Unable to include driverInfo name and version, metadata cannot exceed 512 bytes'
    );
"Unable to include driverInfo name and version, metadata cannot exceed 512 bytes"
let runtimeInfo = getRuntimeInfo()
platform.length > 0
<operator>.formatString("", runtimeInfo, "|", platform, "")
!metadataDocument.ifItFitsItSits('platform', runtimeInfo)
throw new MongoInvalidArgumentError(
      'Unable to include driverInfo platform, metadata cannot exceed 512 bytes'
    );
"Unable to include driverInfo platform, metadata cannot exceed 512 bytes"
const osInfo = new Map()
    .set('name', process.platform)
    .set('architecture', process.arch)
    .set('version', os.release())
    .set('type', os.type())
process.platform
process.arch
os.release()
os.type()
!metadataDocument.ifItFitsItSits('os', osInfo)
_iterator_0 = <operator>.iterator(osInfo.keys())
osInfo.delete(key)
osInfo.size === 0
metadataDocument.ifItFitsItSits('os', osInfo)
const faasEnv = getFAASEnv()
faasEnv != null
!metadataDocument.ifItFitsItSits('env', faasEnv)
_iterator_1 = <operator>.iterator(faasEnv.keys())
faasEnv.delete(key)
faasEnv.size === 0
metadataDocument.ifItFitsItSits('env', faasEnv)
