var updateDb = require('update-browserslist-db')
var fs = require('fs')
var browserslist = require('./')
var pkg = require('./package.json')
var args = process.argv.slice(2)
var USAGE =
  'Usage:\n' +
  '  npx browserslist\n' +
  '  npx browserslist "QUERIES"\n' +
  '  npx browserslist --json "QUERIES"\n' +
  '  npx browserslist --config="path/to/browserlist/file"\n' +
  '  npx browserslist --coverage "QUERIES"\n' +
  '  npx browserslist --coverage=US "QUERIES"\n' +
  '  npx browserslist --coverage=US,RU,global "QUERIES"\n' +
  '  npx browserslist --env="environment name defined in config"\n' +
  '  npx browserslist --stats="path/to/browserlist/stats/file"\n' +
  '  npx browserslist --mobile-to-desktop\n' +
  '  npx browserslist --ignore-unknown-versions\n'
'Usage:\n' +
  '  npx browserslist\n' +
  '  npx browserslist "QUERIES"\n' +
  '  npx browserslist --json "QUERIES"\n' +
  '  npx browserslist --config="path/to/browserlist/file"\n' +
  '  npx browserslist --coverage "QUERIES"\n' +
  '  npx browserslist --coverage=US "QUERIES"\n' +
  '  npx browserslist --coverage=US,RU,global "QUERIES"\n' +
  '  npx browserslist --env="environment name defined in config"\n' +
  '  npx browserslist --stats="path/to/browserlist/stats/file"\n' +
  '  npx browserslist --mobile-to-desktop\n' +
  '  npx browserslist --ignore-unknown-versions\n'
"  npx browserslist
"
"  npx browserslist "QUERIES"
"
"  npx browserslist --json "QUERIES"
"
"  npx browserslist --config="path/to/browserlist/file"
"
"  npx browserslist --coverage "QUERIES"
"
"  npx browserslist --coverage=US "QUERIES"
"
"  npx browserslist --coverage=US,RU,global "QUERIES"
"
"  npx browserslist --env="environment name defined in config"
"
"  npx browserslist --stats="path/to/browserlist/stats/file"
"
"  npx browserslist --mobile-to-desktop
"
"  npx browserslist --ignore-unknown-versions
"
function isArg = function isArg(arg) {
  return args.some(function (str) {
    return str === arg || str.indexOf(arg + '=') === 0
  })
}
function error = function error(msg) {
  process.stderr.write('browserslist: ' + msg + '\n')
  process.exit(1)
}
isArg('--help') || isArg('-h')
isArg('--version') || isArg('-v')
isArg('--update-db')
var mode = 'browsers'
var opts = {}
i < args.length
args[i][0] !== '-'
queries = args[i].replace(/^["']|["']$/g, '')
continue
var arg = args[i].split('=')
var name = arg[0]
var value = arg[1]
value = value.replace(/^["']|["']$/g, '')
name === '--config' || name === '-b'
opts.config = value
name === '--env' || name === '-e'
opts.env = value
name === '--stats' || name === '-s'
opts.stats = value
name === '--coverage' || name === '-c'
mode = 'coverage'
areas = value.split(',')
_tmp_10 = __ecma.Array.factory()
name === '--json'
mode = 'json'
name === '--mobile-to-desktop'
opts.mobileToDesktop = true
name === '--ignore-unknown-versions'
opts.ignoreUnknownVersions = true
error('Unknown arguments ' + args[i] + '.\n\n' + USAGE)
browsers = browserslist(queries, opts)
e.name === 'BrowserslistError'
error(e.message)
throw e
mode === 'browsers'
browsers.forEach(function (browser) {
      process.stdout.write(browser + '\n')
    })
coverage = areas.map(function (area) {
      var stats
      if (area !== 'global') {
        stats = area
      } else if (opts.stats) {
        stats = JSON.parse(fs.readFileSync(opts.stats))
      }
      var result = browserslist.coverage(browsers, stats)
      var round = Math.round(result * 100) / 100.0

      return [area, round]
    })
mode === 'coverage'
var prefix = 'These browsers account for '
(_tmp_13 = process.stdout).write
coverage.forEach(function (data, index) {
        var area = data[0]
        var round = data[1]
        var end = 'globally'
        if (area && area !== 'global') {
          end = 'in the ' + area.toUpperCase()
        } else if (opts.stats) {
          end = 'in custom statistics'
        }

        if (index !== 0) {
          process.stdout.write(prefix.replace(/./g, ' '))
        }

        process.stdout.write(round + '% of all users ' + end + '\n')
      })
mode === 'json'
var data = { browsers: browsers }
data.coverage = coverage.reduce(function (object, j) {
        object[j[0]] = j[1]
        return object
      }, {})
process.stdout.write(JSON.stringify(data, null, '  ') + '\n')
