ChunkStream.prototype._process = function () {
  try {
    // as long as there is any data and read requests
    while (this._buffered > 0 && this._reads && this._reads.length > 0) {
      let read = this._reads[0];

      // read any data (but no more than length)
      if (read.allowLess) {
        this._processReadAllowingLess(read);
      } else if (this._buffered >= read.length) {
        // ok we can meet some expectations

        this._processRead(read);
      } else {
        // not enought data to satisfy first request in queue
        // so we need to wait for more
        break;
      }
    }

    if (this._buffers && !this.writable) {
      this._end();
    }
  } catch (ex) {
    this.emit("error", ex);
  }
}
this._buffered > 0 && this._reads && this._reads.length > 0
let read = this._reads[0]
read.allowLess
this._processReadAllowingLess(read)
this._buffered >= read.length
this._processRead(read)
break;
this._buffers && !this.writable
this._end()
this.emit("error", ex)
