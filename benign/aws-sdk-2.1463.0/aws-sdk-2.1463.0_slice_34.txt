function optionalDiscoverEndpoint = function optionalDiscoverEndpoint(request) {
  var service = request.service;
  var api = service.api;
  var operationModel = api.operations ? api.operations[request.operation] : undefined;
  var inputShape = operationModel ? operationModel.input : undefined;

  var identifiers = marshallCustomIdentifiers(request, inputShape);
  var cacheKey = getCacheKey(request);
  if (Object.keys(identifiers).length > 0) {
    cacheKey = util.update(cacheKey, identifiers);
    if (operationModel) cacheKey.operation = operationModel.name;
  }
  var endpoints = AWS.endpointCache.get(cacheKey);
  if (endpoints && endpoints.length === 1 && endpoints[0].Address === '') {
    //endpoint operation is being made but response not yet received
    //or endpoint operation just failed in 1 minute
    return;
  } else if (endpoints && endpoints.length > 0) {
    //found endpoint record from cache
    request.httpRequest.updateEndpoint(endpoints[0].Address);
  } else {
    //endpoint record not in cache or out...
var service = request.service
var api = service.api
var operationModel = api.operations ? api.operations[request.operation] : undefined
var inputShape = operationModel ? operationModel.input : undefined
var identifiers = marshallCustomIdentifiers(request, inputShape)
var cacheKey = getCacheKey(request)
Object.keys(identifiers).length > 0
cacheKey = util.update(cacheKey, identifiers)
cacheKey.operation = operationModel.name
var endpoints = AWS.endpointCache.get(cacheKey)
endpoints && endpoints.length === 1 && endpoints[0].Address === ''
endpoints && endpoints.length > 0
var endpointRequest = service.makeRequest(api.endpointOperation, {
      Operation: operationModel.name,
      Identifiers: identifiers,
    })
_tmp_5.Operation = operationModel.name
_tmp_5.Identifiers = identifiers
addApiVersionHeader(endpointRequest)
endpointRequest.removeListener('validate', AWS.EventListeners.Core.VALIDATE_PARAMETERS)
endpointRequest.removeListener('retry', AWS.EventListeners.Core.RETRY_CHECK)
AWS.endpointCache.put(cacheKey, [{
      Address: '',
      CachePeriodInMinutes: 1
    }])
_tmp_8.Address = ""
_tmp_8.CachePeriodInMinutes = 1
endpointRequest.send(function(err, data) {
      if (data && data.Endpoints) {
        AWS.endpointCache.put(cacheKey, data.Endpoints);
      } else if (err) {
        AWS.endpointCache.put(cacheKey, [{
          Address: '',
          CachePeriodInMinutes: 1 //not to make more endpoint operation in next 1 minute
        }]);
      }
    })
