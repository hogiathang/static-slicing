async exec () {
    if (this.npm.global) {
      throw Object.assign(new Error('`npm ci` does not work for global packages'), {
        code: 'ECIGLOBAL',
      })
    }

    const where = this.npm.prefix
    const Arborist = require('@npmcli/arborist')
    const opts = {
      ...this.npm.flatOptions,
      packageLock: true, // npm ci should never skip lock files
      path: where,
      save: false, // npm ci should never modify the lockfile or package.json
      workspaces: this.workspaceNames,
    }

    const arb = new Arborist(opts)
    await arb.loadVirtual().catch(er => {
      log.verbose('loadVirtual', er.stack)
      const msg =
        'The `npm ci` command can only install with an existing package-lock.json or\n' +
        'npm-shrinkwrap.json with lockfileVersion >= 1. Run an install with npm@5 or\n' +
        'later to generate a package-lock.json file, then try again.'
      throw this.usageError(msg)
    })

    // retrieves inventory of packages from loaded virtua...
this.npm.global
throw Object.assign(new Error('`npm ci` does not work for global packages'), {
        code: 'ECIGLOBAL',
      })
_tmp_1.code = "ECIGLOBAL"
const where = this.npm.prefix
const Arborist = require('@npmcli/arborist')
const opts = {
      ...this.npm.flatOptions,
      packageLock: true, // npm ci should never skip lock files
      path: where,
      save: false, // npm ci should never modify the lockfile or package.json
      workspaces: this.workspaceNames,
    }
...this.npm.flatOptions
_tmp_2.packageLock = true
_tmp_2.path = where
_tmp_2.save = false
_tmp_2.workspaces = this.workspaceNames
const arb = new Arborist(opts)
await arb.loadVirtual().catch(er => {
      log.verbose('loadVirtual', er.stack)
      const msg =
        'The `npm ci` command can only install with an existing package-lock.json or\n' +
        'npm-shrinkwrap.json with lockfileVersion >= 1. Run an install with npm@5 or\n' +
        'later to generate a package-lock.json file, then try again.'
      throw this.usageError(msg)
    })
const virtualInventory = new Map(arb.virtualTree.inventory)
await arb.buildIdealTree()
const errors = validateLockfile(virtualInventory, arb.idealTree.inventory)
errors.length
throw this.usageError(
        '`npm ci` can only install packages when your package.json and ' +
        'package-lock.json or npm-shrinkwrap.json are in sync. Please ' +
        'update your lock file with `npm install` ' +
        'before continuing.\n\n' +
        errors.join('\n')
      )
'`npm ci` can only install packages when your package.json and ' +
        'package-lock.json or npm-shrinkwrap.json are in sync. Please ' +
        'update your lock file with `npm install` ' +
        'before continuing.\n\n' +
        errors.join('\n')
"package-lock.json or npm-shrinkwrap.json are in sync. Please "
"update your lock file with `npm install` "
"before continuing.

"
errors.join('\n')
await this.npm.time('npm-ci:rm', async () => {
      const path = `${where}/node_modules`
      // get the list of entries so we can skip the glob for performance
      const entries = await fs.readdir(path, null).catch(er => [])
      return Promise.all(entries.map(f => fs.rm(`${path}/${f}`, { force: true, recursive: true })))
    })
await arb.reify(opts)
const ignoreScripts = this.npm.config.get('ignore-scripts')
!ignoreScripts
const scripts = [
        'preinstall',
        'install',
        'postinstall',
        'prepublish', // XXX should we remove this finally??
        'preprepare',
        'prepare',
        'postprepare',
      ]
_tmp_10.push("preinstall")
_tmp_10.push("install")
_tmp_10.push("postinstall")
_tmp_10.push("prepublish")
_tmp_10.push("preprepare")
_tmp_10.push("prepare")
_tmp_10.push("postprepare")
const scriptShell = this.npm.config.get('script-shell') || undefined
