async enable2fa (args) {
    if (args.length > 1) {
      throw new Error('npm profile enable-2fa [auth-and-writes|auth-only]')
    }

    const mode = args[0] || 'auth-and-writes'
    if (mode !== 'auth-only' && mode !== 'auth-and-writes') {
      throw new Error(
        `Invalid two-factor authentication mode "${mode}".\n` +
        'Valid modes are:\n' +
        '  auth-only - Require two-factor authentication only when logging in\n' +
        '  auth-and-writes - Require two-factor authentication when logging in ' +
        'AND when publishing'
      )
    }

    if (this.npm.config.get('json') || this.npm.config.get('parseable')) {
      throw new Error(
        'Enabling two-factor authentication is an interactive operation and ' +
        (this.npm.config.get('json') ? 'JSON' : 'parseable') + ' output mode is not available'
      )
    }

    const info = {
      tfa: {
        mode: mode,
      },
    }

    // if they're using legacy auth currently then we have to
    // ...
args.length > 1
throw new Error('npm profile enable-2fa [auth-and-writes|auth-only]')
const mode = args[0] || 'auth-and-writes'
mode !== 'auth-only' && mode !== 'auth-and-writes'
throw new Error(
        `Invalid two-factor authentication mode "${mode}".\n` +
        'Valid modes are:\n' +
        '  auth-only - Require two-factor authentication only when logging in\n' +
        '  auth-and-writes - Require two-factor authentication when logging in ' +
        'AND when publishing'
      )
`Invalid two-factor authentication mode "${mode}".\n` +
        'Valid modes are:\n' +
        '  auth-only - Require two-factor authentication only when logging in\n' +
        '  auth-and-writes - Require two-factor authentication when logging in ' +
        'AND when publishing'
"Valid modes are:
"
"  auth-only - Require two-factor authentication only when logging in
"
"  auth-and-writes - Require two-factor authentication when logging in "
"AND when publishing"
this.npm.config.get('json') || this.npm.config.get('parseable')
throw new Error(
        'Enabling two-factor authentication is an interactive operation and ' +
        (this.npm.config.get('json') ? 'JSON' : 'parseable') + ' output mode is not available'
      )
'Enabling two-factor authentication is an interactive operation and ' +
        (this.npm.config.get('json') ? 'JSON' : 'parseable') + ' output mode is not available'
this.npm.config.get('json') ? "JSON" : "parseable"
const info = {
      tfa: {
        mode: mode,
      },
    }
_tmp_48.tfa = {
        mode: mode,
      }
_tmp_49.mode = mode
const creds = this.npm.config.getCredentialsByURI(this.npm.config.get('registry'))
const auth = {}
creds.token
auth.token = creds.token
creds.username
auth.basic = { username: creds.username, password: creds.password }
creds.auth
const basic = Buffer.from(creds.auth, 'base64').toString().split(':', 2)
auth.basic = { username: basic[0], password: basic[1] }
!auth.basic && !auth.token
throw new Error(
        'You need to be logged in to registry ' +
        `${this.npm.config.get('registry')} in order to enable 2fa`
      )
'You need to be logged in to registry ' +
        `${this.npm.config.get('registry')} in order to enable 2fa`
<operator>.formatString("", this.npm.config.get('registry'), " in order to enable 2fa")
auth.basic
log.info('profile', 'Updating authentication to bearer token')
const result = await npmProfile.createToken(
        auth.basic.password, false, [], { ...this.npm.flatOptions }
      )
...this.npm.flatOptions
!result.token
throw new Error(
          `Your registry ${this.npm.config.get('registry')} does not seem to ` +
          'support bearer tokens. Bearer tokens are required for ' +
          'two-factor authentication'
        )
`Your registry ${this.npm.config.get('registry')} does not seem to ` +
          'support bearer tokens. Bearer tokens are required for ' +
          'two-factor authentication'
"support bearer tokens. Bearer tokens are required for "
"two-factor authentication"
this.npm.config.setCredentialsByURI(
        this.npm.config.get('registry'),
        { token: result.token }
      )
this.npm.config.get('registry')
_tmp_64.token = result.token
await this.npm.config.save('user')
log.notice('profile', 'Enabling two factor authentication for ' + mode)
const password = await readUserInfo.password()
info.tfa.password = password
log.info('profile', 'Determine if tfa is pending')
const userInfo = await pulseTillDone.withPromise(
      npmProfile.get({ ...this.npm.flatOptions })
    )
npmProfile.get({ ...this.npm.flatOptions })
const conf = { ...this.npm.flatOptions }
userInfo && userInfo.tfa && userInfo.tfa.pending
log.info('profile', 'Resetting two-factor authentication')
await pulseTillDone.withPromise(
        npmProfile.set({ tfa: { password, mode: 'disable' } }, conf)
      )
npmProfile.set({ tfa: { password, mode: 'disable' } }, conf)
userInfo && userInfo.tfa
!conf.otp
conf.otp = await readUserInfo.otp(
          'Enter one-time password: '
        )
"Enter one-time password: "
log.info('profile', 'Setting two-factor authentication to ' + mode)
const challenge = await pulseTillDone.withPromise(
      npmProfile.set(info, conf)
    )
npmProfile.set(info, conf)
challenge.tfa === null
const badResponse = typeof challenge.tfa !== 'string'
      || !/^otpauth:[/][/]/.test(challenge.tfa)
!/^otpauth:[/][/]/.test(challenge.tfa)
throw new Error(
        'Unknown error enabling two-factor authentication. Expected otpauth URL' +
        ', got: ' + inspect(challenge.tfa)
      )
'Unknown error enabling two-factor authentication. Expected otpauth URL' +
        ', got: ' + inspect(challenge.tfa)
inspect(challenge.tfa)
const otpauth = new URL(challenge.tfa)
const secret = otpauth.searchParams.get('secret')
