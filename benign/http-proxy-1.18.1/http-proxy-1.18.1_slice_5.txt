_tmp_2.stream = stream
server.emit('start', req, res, options.target || options.forward)
var agents = options.followRedirects ? followRedirects : nativeAgents
var http = agents.http
var https = agents.https
options.forward
var forwardReq = (options.forward.protocol === 'https:' ? https : http).request(
        common.setupOutgoing(options.ssl || {}, options, req, 'forward')
      )
common.setupOutgoing(options.ssl || {}, options, req, 'forward')
var forwardError = createErrorHandler(forwardReq, options.forward)
req.on('error', forwardError)
forwardReq.on('error', forwardError)
(options.buffer || req).pipe(forwardReq)
!options.target
var proxyReq = (options.target.protocol === 'https:' ? https : http).request(
      common.setupOutgoing(options.ssl || {}, options, req)
    )
common.setupOutgoing(options.ssl || {}, options, req)
proxyReq.on('socket', function(socket) {
      if(server && !proxyReq.getHeader('expect')) {
        server.emit('proxyReq', proxyReq, req, res, options);
      }
    })
options.proxyTimeout
proxyReq.setTimeout(options.proxyTimeout, function() {
         proxyReq.abort();
      })
function createErrorHandler = function createErrorHandler(proxyReq, url) {
      return function proxyError(err) {
        if (req.socket.destroyed && err.code === 'ECONNRESET') {
          server.emit('econnreset', err, req, res, url);
          return proxyReq.abort();
        }

        if (clb) {
          clb(err, req, res, url);
        } else {
          server.emit('error', err, req, res, url);
        }
      }
    }
