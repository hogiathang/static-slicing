function default_1 = async function default_1(tree) {
    // If the workspace doesn't have a nx.json, don't make any changes
    if (!tree.exists('nx.json')) {
        return;
    }
    const nxJson = (0, nx_json_1.readNxJson)(tree);
    // If this is a npm workspace, don't make any changes
    if (nxJson.extends === 'nx/presets/npm.json') {
        return;
    }
    nxJson.namedInputs ??= {
        default: ['{projectRoot}/**/*', 'sharedGlobals'],
        sharedGlobals: [],
        production: ['default'],
    };
    if (nxJson.namedInputs.default) {
        if (!nxJson.namedInputs.production) {
            nxJson.namedInputs.production = ['default'];
        }
        else if (!nxJson.namedInputs.production.includes('default')) {
            nxJson.namedInputs.production = [
                'default',
                ...nxJson.namedInputs.production,
            ];
        }
    }
    if (isBuildATarget(tree)) {
        nxJson.targetDefaults ??= {};
        nxJson.targetDefaults.build ??= {};
        ...
!tree.exists('nx.json')
const nxJson = (0, nx_json_1.readNxJson)(tree)
nxJson.extends === 'nx/presets/npm.json'
nxJson.namedInputs ??= {
        default: ['{projectRoot}/**/*', 'sharedGlobals'],
        sharedGlobals: [],
        production: ['default'],
    }
_tmp_0.default = ['{projectRoot}/**/*', 'sharedGlobals']
_tmp_0.sharedGlobals = __ecma.Array.factory()
_tmp_0.production = ['default']
nxJson.namedInputs.default
!nxJson.namedInputs.production
nxJson.namedInputs.production = ['default']
!nxJson.namedInputs.production.includes('default')
nxJson.namedInputs.production = [
                'default',
                ...nxJson.namedInputs.production,
            ]
_tmp_5.push("default")
_tmp_5.push(...nxJson.namedInputs.production)
isBuildATarget(tree)
nxJson.targetDefaults ??= {}
nxJson.targetDefaults.build ??= {}
nxJson.targetDefaults.build.inputs ??= ['production', '^production']
nxJson.implicitDependencies
const projects = (0, project_configuration_1.getProjects)(tree)
_iterator_0 = <operator>.iterator(Object.entries(nxJson.implicitDependencies))
skippedFiles.includes(files)
continue;
Array.isArray(dependents)
nxJson.namedInputs.projectSpecificFiles = []
const defaultFileset = new Set(nxJson.namedInputs.default ?? ['{projectRoot}/**/*', 'sharedGlobals'])
defaultFileset.add('projectSpecificFiles')
nxJson.namedInputs.default = Array.from(defaultFileset)
_iterator_1 = <operator>.iterator(dependents)
const project = projects.get(dependent)
project.namedInputs ??= {}
const projectSpecificFileset = new Set(project.namedInputs.projectSpecificFiles ?? [])
projectSpecificFileset.add((0, path_1.joinPathFragments)('{workspaceRoot}', files))
project.namedInputs.projectSpecificFiles = Array.from(projectSpecificFileset)
(0, project_configuration_1.updateProjectConfiguration)(tree, dependent, project)
tree.exists((0, path_2.join)(project.root, 'package.json'))
(0, json_1.updateJson)(tree, (0, path_2.join)(project.root, 'package.json'), (json) => {
                                json.nx ??= {};
                                json.nx.namedInputs ??= {};
                                json.nx.namedInputs.projectSpecificFiles ??=
                                    project.namedInputs.projectSpecificFiles;
                                return json;
                            })
nxJson.namedInputs.sharedGlobals.push((0, path_1.joinPathFragments)('{workspaceRoot}', files))
